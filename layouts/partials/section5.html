{{- $section5   := .Site.Params.section5 }}
{{- if eq $section5 true }}
{{- $section5 = dict "_" "_" }}
{{- end }}
{{- $title      := index $section5 "title" | default "Drop us a line or two" }}
{{- $subtitle   := index $section5 "subtitle" | default "We'd love to hear from you" }}
{{- $action     := index $section5 "action" }}
{{- $method     := index $section5 "method" }}
{{- $buttonText := index $section5 "buttonText" | default "Send Message" }}

<section class="section section-light-grey is-medium" id="section5">

  <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "ContactPage",
      "mainEntity": {
        "@type": "LocalBusiness",
        "name": "Lumina Solutions",
        "url": "https://luminasolutions.co.nz",
        "address": {
          "@type": "PostalAddress",
          "addressLocality": "Auckland",
          "addressRegion": "Auckland",
          "addressCountry": "NZ"
        },
        "contactPoint": {
          "@type": "ContactPoint",
          "telephone": "+64 22 3127875",
          "contactType": "Customer Support",
          "areaServed": "NZ",
          "availableLanguage": "English"
        }
      }
    }
  </script>

  <div class="container">
    <div class="title-wrapper has-text-centered" id="contactFormHeading">
      <h2 class="title section-title">{{ $title }}</h2>
      <h3 class="subtitle is-5 is-muted">{{ $subtitle }}</h3>
      <div class="divider is-centered" style="margin-top: 2rem;"></div>
    </div>

    <div class="content-wrapper" style="margin-top: 1rem;">
      <div class="columns">
        <div class="column is-6 is-offset-3">
          <form id="contactForm" action="{{ $action }}" method="{{ $method }}" aria-labelledby="contactFormHeading">
            <div class="columns is-multiline">
              <!-- Full Name -->
              <div class="column is-6">
                <label for="firstName" class="label" style="font-size: 0.875rem;">Full Name</label>
                <input class="input is-small" name="firstName" type="text" placeholder="Enter your full name" required style="font-size: 0.875rem; display: flex; align-items: center; height: 2.5rem; border-radius: 5px;">
              </div>

              <!-- Email -->
              <div class="column is-6">
                <label for="email" class="label" style="font-size: 0.875rem;">Email Address</label>
                <input class="input is-small" name="email" type="email" placeholder="Enter your email address" required style="font-size: 0.875rem; display: flex; align-items: center; height: 2.5rem; border-radius: 5px;">
              </div>

              <!-- Message -->
              <div class="column is-12">
                <label for="message" class="label" style="font-size: 0.875rem;">Your Message</label>
                <textarea class="textarea" name="message" rows="10" placeholder="Enter your message" required style="font-size: 0.875rem; display: flex; align-items: center; height: 6rem; border-radius: 5px;"></textarea>
              </div>

              <!-- Submit -->
              <div class="column is-12" style="display: flex; justify-content: center;">
                <button type="submit" class="button cta is-small primary-btn raised is-clear" style="font-size: 0.875rem; display: flex; align-items: center; border-radius: 5px; width: auto; padding: 0.5rem 1.25rem; background-color: #2b343d; color: white;">
                  {{ $buttonText }}
                </button>
              </div>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>
</section>

<script>
  document.getElementById("contactForm").addEventListener("submit", function(event) {
    event.preventDefault();

    var formData = new FormData(this);

    fetch("{{ $action }}", {
      method: "{{ $method }}",
      body: formData
    })
    .then(response => {
      if (!response.ok) {
        throw new Error('Form submission failed. Please try again later.');
      }
      return response.json();
    })
    .then(data => {
      alert("Thank you for your message! We will get back to you soon.");
      document.getElementById("contactForm").reset();
    })
    .catch(error => {
      console.error("Error submitting form: ", error);
      alert("Thank you for your message! We will get back to you soon.");
      document.getElementById("contactForm").reset();
    });
</script>
